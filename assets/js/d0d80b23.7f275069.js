"use strict";(self.webpackChunkapi_docs_generator=self.webpackChunkapi_docs_generator||[]).push([[196],{2037:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"tech/aggregator","title":"Ramp Aggregator","description":"API description","source":"@site/docs/tech/aggregator.md","sourceDirName":"tech","slug":"/tech/aggregator","permalink":"/docs/tech/aggregator","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Overview","permalink":"/docs/tech/overview"},"next":{"title":"Web3 SDK","permalink":"/docs/tech/sdk"}}');var t=s(4848),o=s(8453);const i={},d="Ramp Aggregator",a={},c=[{value:"API description",id:"api-description",level:2},{value:"Usage of SDK",id:"usage-of-sdk",level:2},{value:"End to end example of SDK usage",id:"end-to-end-example-of-sdk-usage",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"ramp-aggregator",children:"Ramp Aggregator"})}),"\n",(0,t.jsx)(n.h2,{id:"api-description",children:"API description"}),"\n",(0,t.jsxs)(n.p,{children:["A detailed description of requests and responses fields can be found in\nthe ",(0,t.jsx)(n.a,{href:"https://github.com/harbour-tech/harbour-ts-sdk/blob/main/proto/ramp/v1/public.proto",children:"proto definitions"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["The ist of supported fiat currencies can be found in ",(0,t.jsx)(n.strong,{children:"CurrencyId"})," enum\nof ",(0,t.jsx)(n.a,{href:"https://github.com/harbour-tech/harbour-ts-sdk/blob/main/proto/ramp/v1/public.proto",children:"proto definitions"}),", also take\na look at our ",(0,t.jsx)(n.a,{href:"/docs/assets",children:"Supported Assets"})," docs."]}),"\n",(0,t.jsxs)(n.p,{children:["The list of supported countries can be found ",(0,t.jsx)(n.a,{href:"/docs/countries-payments",children:"here"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"usage-of-sdk",children:"Usage of SDK"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Reach out Harbour support to get assigned referral code and to register webhook for transactions notification (if\nrequired)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Copy ",(0,t.jsx)(n.code,{children:"src/index.ts"})," and ",(0,t.jsx)(n.code,{children:"src/gen/**"})," into your project"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Configure RampClient to one of the endpoints"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Development environment: ",(0,t.jsx)(n.code,{children:"https://dev-api.harborapps-nonprod.link"})]}),"\n",(0,t.jsxs)(n.li,{children:["Production environment: ",(0,t.jsx)(n.code,{children:"https://api.harborapp.link"})]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Typscript",children:'import Ramp from \'.\'\nimport {GetAssetsRequest, CurrencyId} from "./gen/ramp/v1/public_pb";\nconst ramp = new RampCLient("https://dev-api.harborapps-nonprod.link");\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Get list of available assets"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Typscript",children:"const assetsResponse = ramp.getAssets(new GetAssetsRequest({fiatAssetId: CurrencyId.EUR}));\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Please check ",(0,t.jsx)(n.strong,{children:"GetAssetsResponse"}),"\nof ",(0,t.jsx)(n.a,{href:"https://github.com/harbour-tech/harbour-ts-sdk/blob/main/proto/ramp/v1/public.proto",children:"proto definitions"})," for\ndetailed documentation\nover response data"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Estimate on-ramp"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Typscript",children:'const onRampFeeResponse = await ramp.estimateOnRampFee(new EstimateOnRampFeeRequest({\n  fiatAssetId: CurrencyId.EUR,\n  cryptoAssetId: assetsResponse.cryptoAssets[0].assetId,\n  protocol: assetsResponse.cryptoAssets[0].protocol,\n  amount:  {\n    case:"fiatAssetAmount",\n    value: "100",\n  },\n}));\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Please check ",(0,t.jsx)(n.strong,{children:"EstimateOnRampFeeResponse"}),"\nof ",(0,t.jsx)(n.a,{href:"https://github.com/harbour-tech/harbour-ts-sdk/blob/main/proto/ramp/v1/public.proto",children:"proto definitions"})," for\ndetailed\ndocumentation over response data"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Estimate off-ramp"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Typscript",children:'const offRampFeeResponse = await ramp.estimateOffRampFee(new EstimateOffRampFeeRequest({\n  fiatAssetId: CurrencyId.EUR,\n  cryptoAssetId: assetsResponse.cryptoAssets[0].assetId,\n  protocol: assetsResponse.cryptoAssets[0].protocol,\n  amount:  {\n    case:"cryptoAssetAmount",\n    value: "100",\n  },\n}));\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Please check ",(0,t.jsx)(n.strong,{children:"EstimateOffRampFeeResponse"}),"\nof ",(0,t.jsx)(n.a,{href:"https://github.com/harbour-tech/harbour-ts-sdk/blob/main/proto/ramp/v1/public.proto",children:"proto definitions"})," for\ndetailed\ndocumentation over response data"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Open a popup window passing parameters"}),"\n",(0,t.jsxs)(n.p,{children:["Once user selected Harbour as ramp provider user should be directed to Harbour ramp web app at\n",(0,t.jsx)(n.code,{children:"https://.../?origin={metamask}&op={buy|sell}&amount=100&asset={ASSET_ID_USDC|ASSET_ID_ETH|...}&protocol={PROTOCOL_ETHEREUM|PROTOCOL_POLYGON|...}&currency={CURRENCY_ID_EUR}"})]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Example values"}),(0,t.jsx)(n.th,{children:"Notes"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"op"}),(0,t.jsx)(n.td,{children:"buy, sell"}),(0,t.jsx)(n.td,{})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"amount"}),(0,t.jsx)(n.td,{children:"100"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"fiat"})," for ",(0,t.jsx)(n.code,{children:"buy"})," operation and in ",(0,t.jsx)(n.code,{children:"crypto"})," for ",(0,t.jsx)(n.code,{children:"sell"})," operation ",(0,t.jsx)("br",{}),(0,t.jsx)(n.code,{children:"."})," should be used as the decimal separator for ",(0,t.jsx)(n.code,{children:"amount"})," ",(0,t.jsx)("br",{})," ",(0,t.jsx)(n.code,{children:"amount"})," would be truncated if it exceeds the decimal precision of the fiat or crypto asset."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"asset"}),(0,t.jsx)(n.td,{children:"ASSET_ID_USDC, ASSET_ID_ETH, ..."}),(0,t.jsxs)(n.td,{children:["look into ",(0,t.jsx)(n.code,{children:"AssetId"})," definition in proto"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"protocol"}),(0,t.jsx)(n.td,{children:"PROTOCOL_ETHEREUM, PROTOCOL_POLYGON, ..."}),(0,t.jsxs)(n.td,{children:["look into ",(0,t.jsx)(n.code,{children:"Protocol"})," definition in proto"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"wallet_address"}),(0,t.jsx)(n.td,{children:'"0x134ad..."'}),(0,t.jsx)(n.td,{children:"wallet address"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"currency"}),(0,t.jsx)(n.td,{children:"CURRENCY_ID_EUR, ..."}),(0,t.jsxs)(n.td,{children:["look into ",(0,t.jsx)(n.code,{children:"CurrencyId"})," definition in proto"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"referral_code"}),(0,t.jsx)(n.td,{children:"'refferal_xyz'"}),(0,t.jsx)(n.td,{children:"assigned to the partner by Harbour"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"referral_transaction_id"}),(0,t.jsx)(n.td,{children:"'tx123'"}),(0,t.jsx)(n.td,{children:"any string containing only letters (any case), numbers, '_' and '-'"})]})]})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"As soon as ramp transaction changes it's status partner webhook will be invoked"}),"\n",(0,t.jsxs)(n.p,{children:["Complete ",(0,t.jsx)(n.code,{children:"RampTransaction"})," definition can be found in\nthe ",(0,t.jsx)(n.a,{href:"https://github.com/harbour-tech/harbour-ts-sdk/blob/main/proto/ramp/v1/public.proto",children:"proto definitions"}),".\nWebhook's payload is JSON encoded by default. Example payload:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "transactionId" : "00000000-0000-0000-0000-000000000000",\n  "referralTransactionId": "tx123",\n  "type": "RAMP_TYPE_ON_RAMP",\n  "status": "RAMP_STATUS_COMPLETED",\n  "currencyId": "CURRENCY_ID_EUR",\n  "cryptoAssetId": "ASSET_ID_USDC",\n  "cryptoAssetProtocol": "PROTOCOL_ETHEREUM",\n  "fiatAmount": "100.1",\n  "cryptoAmount": "105.456",\n  "exchangeRate": "1.07",\n  "fees": {\n    "processingFee": "0.5",\n    "networkFee": "3.1",\n    "referralFee": "0.5"\n  },\n  "walletAddress": "0x904Efd640CcA70Efaf5c29421CF507E4\u203aB7bFc71B",\n  "initiatedAt": "2024-08-22T00:00:00Z",\n  "completedAt": "2024-08-22T00:00:00Z"\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"end-to-end-example-of-sdk-usage",children:"End to end example of SDK usage"}),"\n",(0,t.jsxs)(n.p,{children:["End to end example of SDK usage can be\nfound ",(0,t.jsx)(n.a,{href:"https://github.com/harbour-tech/harbour-ts-sdk/blob/main/src/examples/example-aggregator.ts",children:"here"})," and can be\nexecuted with following command"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"npm i\nnpx tsx src/examples/example-aggregator.ts\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>d});var r=s(6540);const t={},o=r.createContext(t);function i(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);